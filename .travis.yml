language: python
cache: pip

python:
  - 2.7

services:
  - postgresql

addons:
  postgresql: "9.4"

install:
  - pip install tox

before_script:
  - psql -c "CREATE DATABASE vitriolic;" -U postgres

script:
  - tox

env:
  matrix:
    - TOXENV=py27-django-1.8-pg94
    - TOXENV=py27-django-1.8-pg96
    - TOXENV=py27-django-1.10-pg94
    - TOXENV=py27-django-1.10-pg96
    - TOXENV=py27-django-1.11-pg94
    - TOXENV=py27-django-1.11-pg96

  global:
    - DATABASE_URL=postgresql://postgres@localhost/travis
    - secure: |
        MlIb9De0pI5cjwaqPjpI01/XdjlSKf7oIT/yAKMWIxUPvNNewJAjfTR0DYgjX/gh0k7rYgw
        XzkHRFY07yliGkruTMmIqfFMDJJ6XHUEyxY0upjmxd0EBpcCgkYAr8KF6tl+OZwpKFBH1gc
        2x6i/+YjjZFlhozaodBnyk7M9QcaZDxmiRHu8E4sH/9t6JMV9Iu6uM8HeS37hQNV/WinEIZ
        Uoaf8hzVdRn/LaEC6N/gL+g56P5k0d4JZRkPvEAi0Qq6NR7pXz3zhzOzSlQnOhfBC+h+xNL
        t/wyJP+f4aLrc0YpJ31jkjZVzMl5eXjDka05zmT0mkVNBlIr+8rkDTRWmjm3riLmGIRQYhR
        uPu35tz0I8VxBsZd8FDbFMptk4FXJmj/jrdlQFAUR6AN3aDz6huGVWyHBjMDyNcQjaHs8vp
        pt3wOnm1MofE0tiCQZZW/DuX+AdpIkwjeLZqDA/2vq/jCWbPWxVpJVvxQrGrWkvVz0yVE1G
        pSTAOIp9P7H6rT71y3VrgTpO3Gdx0NcCxAE+OdS7VvjyIDmn151KhTTyxOQFkc3n3GFSpMU
        ps9qPFOp+o6XaI452F6pbF4q5F+A+FeJhx5X9ip4E7u6a4bLx661+cp9mXsdqvYJ7n94ydy
        oe8UhCkmLRdL+m3A+vHoKgsHSr+fxmOU7eepBKHrsCYU=

deploy:
  provider: pypi
  user: goodtune
  password:
    secure: |
      hHZwAc0IfbgX2nTgExVLcZ+09VNa5iciiNDQ1ZMLnFZ/SsDVnIs7D0wBWBVQsyrjrj2ZPFZ
      +pPeGymx7njO4mZZFZm+YgrHIcpE/+AnkvdnVXLQCKSs9Ihg/8O3C6972HlWl2z7TcsDFJU
      9XQibz9s1o9X3niP54fSCSuB5vKBfCcKuWMB9AD3HfQvVAI67jZ/hFqdfAY7sMduGTOVTka
      ArChGrNbsDMCPLXQMQM0cXUjxnHabcfi3uKOR9px8o/FO5XiLS5o3MoiBDy+QLz+yREKIaE
      4cfx6/Y5cBBzZx/opuv7iAN0sHeBNRElRqvFafQ4VtRcQxT9XyqIuX5Y7wkfb7X3Aorz4Jl
      1dh8p/H5Vro1wrWGD9S41F4yPk14M4JhT+BWBY08AtJ+o0HnQwuOTqAghVQLgTAIAYQyn+u
      CrUW7SKma++c8CayFcip3CoK9pYo35owJDTTyJK3TcZyMhluuIQhxWzw/o75DukgM/OCtuQ
      FYPpfo6nvJo96UXoLBR77mPXQX1CpRIEMD8y+cRL1va7KLQQC4++0bsQnDiQRJcFUEgulAt
      M0FrurUkz9dnXKRegoL+tuObRxHBAaA90SHooSbF8x6RzhtoRG5yzjUNTwt1Y54cRushO0T
      oIoigKvKkIM4gpVthmwi6qm6xOQUN818YLXAQRVZhtxY=
  on:
    tags: true
    repo: goodtune/vitriolic
